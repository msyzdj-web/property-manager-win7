# Windows 7 依赖安装说明

## 当前状态

✅ Python 3.8.10 已安装
⚠️ 网络连接可能有问题（SSL/代理设置）

## 安装方式

### 方式一：使用国内镜像源（推荐）

如果遇到网络问题，可以使用国内镜像源加速安装：

**运行脚本：**
```bash
安装Win7依赖-使用镜像.bat
```

**或手动安装：**
```bash
# 使用清华镜像源
py -3.8 -m pip install PyQt5==5.15.10 -i https://pypi.tuna.tsinghua.edu.cn/simple
py -3.8 -m pip install SQLAlchemy==1.4.46 -i https://pypi.tuna.tsinghua.edu.cn/simple
py -3.8 -m pip install pyinstaller==4.10 -i https://pypi.tuna.tsinghua.edu.cn/simple
py -3.8 -m pip install openpyxl==3.1.2 -i https://pypi.tuna.tsinghua.edu.cn/simple
py -3.8 -m pip install pandas==1.5.3 -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 方式二：配置永久镜像源

如果经常遇到网络问题，可以配置永久镜像源：

```bash
# 创建 pip 配置目录
mkdir %APPDATA%\pip

# 创建配置文件（使用清华镜像）
echo [global] > %APPDATA%\pip\pip.ini
echo index-url = https://pypi.tuna.tsinghua.edu.cn/simple >> %APPDATA%\pip\pip.ini
echo trusted-host = pypi.tuna.tsinghua.edu.cn >> %APPDATA%\pip\pip.ini

# 然后正常安装
py -3.8 -m pip install -r requirements-win7.txt
```

### 方式三：手动下载安装

如果网络问题持续，可以手动下载 wheel 文件安装：

1. **访问 PyPI 网站下载 wheel 文件：**
   - PyQt5: https://pypi.org/project/PyQt5/5.15.10/#files
   - SQLAlchemy: https://pypi.org/project/SQLAlchemy/1.4.46/#files
   - PyInstaller: https://pypi.org/project/pyinstaller/4.10/#files
   - openpyxl: https://pypi.org/project/openpyxl/3.1.2/#files
   - pandas: https://pypi.org/project/pandas/1.5.3/#files

2. **下载对应的 .whl 文件（选择 Python 3.8 版本）**

3. **本地安装：**
   ```bash
   py -3.8 -m pip install 下载的文件路径\包名.whl
   ```

## 常用镜像源

- **清华镜像**：https://pypi.tuna.tsinghua.edu.cn/simple
- **阿里云镜像**：https://mirrors.aliyun.com/pypi/simple/
- **中科大镜像**：https://pypi.mirrors.ustc.edu.cn/simple/
- **豆瓣镜像**：https://pypi.douban.com/simple/

## 验证安装

安装完成后，验证所有包是否已安装：

```bash
py -3.8 -m pip list
```

应该看到：
- PyQt5 5.15.10
- SQLAlchemy 1.4.46
- pyinstaller 4.10
- openpyxl 3.1.2
- pandas 1.5.3

## 下一步

安装完依赖后，运行：
```bash
build-win7.bat
```

开始打包 Windows 7 兼容版本。

