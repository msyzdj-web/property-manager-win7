# 手动安装 Windows 7 依赖指南

## 当前问题

检测到网络连接问题（可能是代理或 SSL 配置），无法通过 pip 自动安装。

## 解决方案

### 方案一：修复网络问题后安装

#### 1. 检查代理设置

如果使用代理，需要配置 pip 使用代理：

```bash
# 设置代理（根据实际情况修改）
py -3.8 -m pip install --proxy http://代理地址:端口 PyQt5==5.15.10
```

#### 2. 禁用 SSL 验证（不推荐，仅用于测试）

```bash
py -3.8 -m pip install --trusted-host pypi.org --trusted-host pypi.python.org --trusted-host files.pythonhosted.org PyQt5==5.15.10
```

#### 3. 使用离线安装

如果网络问题无法解决，可以：

1. **在其他有网络的机器上下载 wheel 文件**
2. **传输到当前机器**
3. **本地安装**

### 方案二：使用 GitHub Actions（推荐）

由于网络问题，**强烈推荐使用 GitHub Actions 自动打包**：

1. **将代码推送到 GitHub**
2. **在 GitHub Actions 中运行打包工作流**
3. **下载打包好的 exe 文件**

这样不需要在本地安装依赖，GitHub 的服务器网络通常很稳定。

### 方案三：手动下载 wheel 文件安装

#### 步骤 1：下载 wheel 文件

访问以下链接，下载对应的 `.whl` 文件（选择 Python 3.8 版本）：

1. **PyQt5 5.15.10**
   - 访问：https://pypi.org/project/PyQt5/5.15.10/#files
   - 下载：`PyQt5-5.15.10-cp38-cp38-win_amd64.whl`（64位）

2. **SQLAlchemy 1.4.46**
   - 访问：https://pypi.org/project/SQLAlchemy/1.4.46/#files
   - 下载：`SQLAlchemy-1.4.46-cp38-cp38-win_amd64.whl`（64位）

3. **PyInstaller 4.10**
   - 访问：https://pypi.org/project/pyinstaller/4.10/#files
   - 下载：`pyinstaller-4.10-py3-none-any.whl`

4. **openpyxl 3.1.2**
   - 访问：https://pypi.org/project/openpyxl/3.1.2/#files
   - 下载：`openpyxl-3.1.2-py2.py3-none-any.whl`

5. **pandas 1.5.3**
   - 访问：https://pypi.org/project/pandas/1.5.3/#files
   - 下载：`pandas-1.5.3-cp38-cp38-win_amd64.whl`（64位）

#### 步骤 2：本地安装

将所有下载的 `.whl` 文件放到一个文件夹（如 `wheels`），然后：

```bash
# 进入文件夹
cd wheels

# 逐个安装
py -3.8 -m pip install PyQt5-5.15.10-cp38-cp38-win_amd64.whl
py -3.8 -m pip install SQLAlchemy-1.4.46-cp38-cp38-win_amd64.whl
py -3.8 -m pip install pyinstaller-4.10-py3-none-any.whl
py -3.8 -m pip install openpyxl-3.1.2-py2.py3-none-any.whl
py -3.8 -m pip install pandas-1.5.3-cp38-cp38-win_amd64.whl
```

### 方案四：使用 conda（如果已安装）

如果系统安装了 Anaconda 或 Miniconda：

```bash
# 创建 Python 3.8 环境
conda create -n win7 python=3.8 -y
conda activate win7

# 安装依赖
conda install pyqt=5.15.10 -c conda-forge
pip install SQLAlchemy==1.4.46
pip install pyinstaller==4.10
pip install openpyxl==3.1.2
pip install pandas==1.5.3
```

## 验证安装

无论使用哪种方式，安装完成后验证：

```bash
py -3.8 -m pip list | findstr /i "PyQt5 SQLAlchemy pyinstaller openpyxl pandas"
```

应该看到：
- PyQt5 5.15.10
- SQLAlchemy 1.4.46
- pyinstaller 4.10
- openpyxl 3.1.2
- pandas 1.5.3

## 推荐方案

**最推荐：使用 GitHub Actions**

1. 不需要解决网络问题
2. 自动化打包
3. 结果可靠
4. 可以重复执行

**步骤：**
1. 将代码提交到 Git
2. 推送到 GitHub
3. 在 GitHub Actions 中运行 "Build Windows 7 Compatible EXE"
4. 下载打包结果

## 下一步

安装完依赖后，运行：
```bash
build-win7.bat
```

开始打包！

